function postData(e,t){var n={},o=[];e.dataset.id?o.push(e.dataset.id):Array.prototype.forEach.call(document.querySelectorAll("[data-id]"),function(e){o.push(e.dataset.id)}),0===o.length?tipsF({code:2801,desc:"您已领取全部代金券"}):(n.baseId=o,t&&Object.assign(n,t),new xAjax({url:mainUrl+"lottery.do",type:"post",data:n,dataType:"json",success:function(t){t&&tipsF(t,e)}}))}function tipsF(e,t){if((2900===e.code||2901===e.code||2902===e.code||2801===e.code)&&(tips.textContent=e.desc,tips.addClass("tips-in"),setTimeout(function(){document.querySelector(".tips").removeClass("tips-in")},1600),2900===e.code&&new xAjax({url:mainUrl+"getBindVoucherByMid",type:"get",dataType:"json",success:function(e){var t=tppl(document.getElementById("list").innerHTML,e);document.querySelector(".list").innerHTML=t}})),2001===e.code&&AndroidClient.doLogin(),2903===e.code&&(over.removeClass("dn"),bindPhone.removeClass("dn")),2905===e.code)if("undefined"==typeof initGeetest){var n=document.createElement("script");n.onload=function(){check(t)},n.src="http://static.geetest.com/static/tools/gt.js",document.body.appendChild(n)}else check(t)}function check(e){new xAjax({url:"/getGeetestKey?t="+(new Date).getTime(),type:"get",dataType:"json",success:function(t){initGeetest({gt:t.gt,challenge:t.challenge,offline:!t.success,product:"embed",width:"600px"},function(t){handler(t,e)})}})}var AndroidClient={},mainUrl="/newperson/";if("undefined"==typeof AndroidClient)document.querySelector(".main").addClass("dn"),document.querySelector(".tip-page").removeClass("dn");else{document.querySelector(".rule").eventsBind("click",function(){document.querySelector(".over").removeClass("dn"),document.querySelector(".rule-box").removeClass("dn")}),document.querySelector(".rule-box>h4>i").eventsBind("click",function(){document.querySelector(".over").addClass("dn"),document.querySelector(".rule-box").addClass("dn")}),document.getElementById("cancelBtn").eventsBind("click",function(){document.querySelector(".over").addClass("dn"),document.querySelector(".bind-phone").addClass("dn")}),new xAjax({url:"sample.json",type:"get",dataType:"json",success:function(e){var t=tppl(document.getElementById("list").innerHTML,e);document.querySelector(".list").innerHTML=t}});var tips=document.querySelector(".tips"),bindPhone=document.querySelector(".bind-phone"),over=document.querySelector(".over");document.getElementById("cancelBtn").eventsBind("click",function(){bindPhone.addClass("dn"),over.addClass("dn")}),document.querySelector("body").eventsBind("click",function(){postData(this)},".get-js");var handler=function(e,t){document.querySelector(".over").removeClass("dn"),document.getElementById("captcha").removeClass("dn"),e.appendTo("#captcha"),e.onSuccess(function(){var n=e.getValidate();return n?(document.querySelector(".over").addClass("dn"),document.getElementById("captcha").addClass("dn"),document.getElementById("captcha").innerHTML="",void postData(t,{geetest_challenge:n.geetest_challenge,geetest_validate:n.geetest_validate,geetest_seccode:n.geetest_seccode})):alert("请完成验证")})}}touchControl(document.querySelector(".rule-box section"));